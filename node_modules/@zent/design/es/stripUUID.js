import _isArray from 'lodash/isArray';
import _isPlainObject from 'lodash/isPlainObject';
import _has from 'lodash/has';


var UUID_KEY_PATTERN = /__.+uuid__/i;
var OLD_KEY = 'zent-design-uuid';

export default function stripUUID(value) {
  if (_isPlainObject(value)) {
    // eslint-disable-next-line
    for (var key in value) {
      if (_has(value, key)) {
        if (OLD_KEY === key || UUID_KEY_PATTERN.test(key)) {
          delete value[key];
        } else {
          var oldValue = value[key];
          var newValue = stripUUID(oldValue);
          if (newValue !== oldValue) {
            value[key] = newValue;
          }
        }
      }
    }
  } else if (_isArray(value)) {
    value.forEach(function (v) {
      return stripUUID(v);
    });
  }

  return value;
}